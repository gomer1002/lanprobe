# LANProbe — Простой тест пропускной способности сети на Python

**LANProbe** — лёгкий консольный скрипт на Python для измерения реальной пропускной способности сети с поддержкой **TCP** и **UDP**.

# LANProbe — Simple Network Bandwidth Test Tool in Python

**LANProbe** is a lightweight console script written in Python for measuring real-world network throughput using both **TCP** and **UDP** protocols.

## Особенности

- Измерение скорости приёма данных в Мбит/с с выводом каждую секунду
- Отображение средней скорости по окончании теста
- Измерение начальной задержки (latency) до первого пакета
- **TCP**: классическое соединение, поддержка нескольких клиентов подряд
- **UDP**: сервер генерирует постоянный поток данных (unicast или broadcast), клиент просто слушает порт и начинает замер при обнаружении трафика (ничего не отправляет серверу)
- Настраиваемый размер пакета
- Минимальные зависимости — только стандартная библиотека Python

Идеально подходит для быстрого тестирования локальной сети (LAN), проверки максимальной скорости канала или отладки сетевых проблем.

## Установка и запуск

Скрипт не требует установки дополнительных пакетов.

```bash
git clone https://github.com/yourusername/lanprobe.git
cd lanprobe
python lanprobe.py --help
```

Или просто скачайте файл `lanprobe.py` и запускайте напрямую:

```bash
python lanprobe.py server ...
python lanprobe.py client ...
```

## Параметры командной строки

### Общие параметры

| Параметр | Описание                            | Значение по умолчанию |
| -------- | ----------------------------------- | --------------------- |
| `mode`   | Режим работы: `server` или `client` | **обязательный**      |
| `--type` | Протокол: `tcp` или `udp`           | `tcp`                 |
| `--port` | Порт для прослушивания/подключения  | `5000`                |

### Параметры клиента (режим `client`)

| Параметр | Описание                               | Значение по умолчанию |
| -------- | -------------------------------------- | --------------------- |
| `--host` | IP-адрес сервера                       | `127.0.0.1`           |
| `--time` | Продолжительность измерения в секундах | `10.0`                |

### Параметры сервера (режим `server`)

| Параметр   | Описание                                                                         | Значение по умолчанию |
| ---------- | -------------------------------------------------------------------------------- | --------------------- |
| `--speed`  | Целевая скорость генерации трафика в Мбит/с                                      | `10.0`                |
| `--packet` | Размер одного пакета в байтах (рекомендуется ≤ MTU сети, обычно 1400–1472)       | `1400`                |
| `--target` | Целевой IP-адрес клиента (unicast). Если не указан — broadcast (255.255.255.255) | `None` (broadcast)    |

## Примеры использования

### 1. TCP-тест

**Сервер**

```bash
python lanprobe.py server --type tcp --speed 500 --packet 1400 --port 5000
```

**Клиент**

```bash
python lanprobe.py client --type tcp --host 192.168.1.100 --time 20 --port 5000
```

### 2. UDP broadcast (удобно в локальной сети)

**Сервер**

```bash
python lanprobe.py server --type udp --speed 200 --packet 1400 --port 5000
```

**Клиент** (на любом устройстве в той же подсети)

```bash
python lanprobe.py client --type udp --time 15 --port 5000
```

### 3. UDP unicast (точная передача на конкретный клиент)

**Сервер**

```bash
python lanprobe.py server --type udp --speed 800 --target 192.168.1.114 --packet 8000 --port 5000
```

**Клиент**

```bash
python lanprobe.py client --type udp --time 10 --port 5000
```

## Пример вывода клиента

```
=== Параметры запуска ===
Режим: Клиент
Протокол: UDP
Хост: 127.0.0.1
Порт: 5000
Время измерения: 15.0 секунд
========================

Ожидание UDP-трафика на порту 5000...
Обнаружен трафик от ('192.168.1.100', 5000)
Задержка до первого пакета: 12.4 мс

[   1.0s] Текущая скорость: 198.45 Мбит/с (всего: 24.81 МБ)
[   2.0s] Текущая скорость: 201.32 Мбит/с (всего: 50.17 МБ)
...
[  15.0s] Текущая скорость: 199.87 Мбит/с (всего: 374.92 МБ)

Итоговая средняя скорость: 200.15 Мбит/с за 15.0 секунд (374.92 МБ)
```

## Рекомендации

- Для UDP избегайте пакетов больше MTU сети (стандартно 1500 байт). Безопасное значение — 1400.
- Если сеть поддерживает jumbo frames, можно увеличить `--packet` до 8000–9000.
- Сервер работает бесконечно. Остановка — Ctrl+C.

## Лицензия

MIT License — используйте свободно.
